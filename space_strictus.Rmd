---
title: "Vowel Dispersion in Ictus and Stress"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*.

```{r}
library("sjPlot")
library("lme4")
library("ggplot2")
library("broom")
library("dplyr")
spata_df <- read.csv("vowel_master.csv", header= TRUE)


spata_df$ictus <- as.factor(spata_df$ictus)
spata_df$stressed <- as.factor(spata_df$stressed)
spata_df$stressed <- recode_factor(spata_df$stressed, "0" = "unstressed","1" = "stressed")
spata_df$quantity <- as.factor(spata_df$quantity)
spata_df$song <- as.factor(spata_df$song)
spata_df$shape <- as.factor(spata_df$shape)

spata_df$word <- as.factor(spata_df$word)
spata_df
```

```{r}
#filter out all vowel phonemes that don't occur in both stressed and unstressed positions in Estonian
space_data <- filter(spata_df, spata_df$quantity != "3" & (spata_df$segment == "a" |spata_df$segment == "aa"|spata_df$segment == "aː"| spata_df$segment == "e" |spata_df$segment == "ee"| spata_df$segment == "eː"  | spata_df$segment == "i" | spata_df$segment == "ii"| spata_df$segment == "iː" | spata_df$segment == "o"| spata_df$segment == "oo"| spata_df$segment == "oː") )
                     
#spata_df$quantity!="3" & spata_df$segment != "ø"
#&spata_df$segment != "øː"& spata_df$segment !=  "ɵ"&spata_df$segment !=  "ɵɵ"
#& spata_df$segment != "ɵː" &spata_df$segment != "æ"&spata_df$segment != "æː"
#& spata_df$segment != "ææ" & spata_df$segment != "y")

(space_data)
```

```{r}

ggplot(space_data, aes(ictus,euclid)) + 
  geom_jitter(color = "violet", alpha = 0.5) +
  facet_wrap("song") +
  labs(x = "beat position", y = "vowel dispersion") + 
  theme_classic()
ggsave("song_euc_ictus.png")
space_data %>%
  arrange(euclid) %>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%
  ggplot(aes(stressed,euclid)) + 
    geom_jitter(color = "orange", alpha = 0.5) +
    facet_wrap("song") +
    labs(x = "word stress", y = "vowel dispersion") + 
    theme_classic()
ggsave("song_euc_stress.png")
ggplot(space_data, aes(ictus,euclid)) + 
  geom_jitter(color = "violet", alpha = 0.5) +
  facet_wrap("performer") +
  labs(x = "beat position", y = "vowel dispersion") + 
  theme_minimal()
ggsave("perf_euc_ictus.png")
  space_data %>%
  arrange(euclid) %>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%
  ggplot(aes(stressed,euclid)) + 
    geom_jitter(color = "orange", alpha = 0.5) +
    facet_wrap("performer") +
    labs(x = "word stress", y = "vowel dispersion") + 
    theme_minimal()
ggsave("perf_euc_stress.png")
```

```{r}
space_data %>%
  arrange(euclid) %>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%
  ggplot(aes(x=ictus ,y=euclid,fill = stressed)) + 
  
  geom_boxplot(alpha = 0.5)  + 
  
  #geom_jitter( alpha = 0.5) +
  theme_classic() +
  
  facet_wrap("quantity")
  labs( xlab = "beat" ,ylab = "euclidean distance") 

ggsave('space_strictus.png')
```

```{r}
desmd <- lmer(euclid ~ stressed + ictus + stressed*ictus + (1|segment) + (1|song) + (1|performer), REML = FALSE, data = space_data )
summary(desmd)
```

```{r}
tab_model(desmd)
```

```{r}
des_null_md <- lmer(euclid ~  (1|segment) + (1|song) +(1|performer), REML = FALSE, data = space_data )
summary(des_null_md)
```

```{r}
tab_model(des_null_md)
```

```{r}
spc_comp <- anova(desmd,des_null_md)
print(spc_comp)
```
