---
title: "Q1 and Q2 duration in stress and ictus"
output: html_notebook
---

```{r setup}
library("sjPlot")
library("lme4")
library("ggplot2")
library("broom")
library("dplyr")
library("ggpattern")
data_df <- read.csv("vowel_master.csv", header= TRUE)


data_df$ictus <- as.factor(data_df$ictus)
data_df$stressed <- as.factor(data_df$stressed)
data_df$stressed <- recode_factor(data_df$stressed, "0" = "unstressed","1" = "stressed")
data_df$quantity <- as.factor(data_df$quantity)
data_df$shape <- as.factor(data_df$shape)
data_df$song <- as.factor(data_df$song)
data_df$word <- as.factor(data_df$word)
#head(data_df)

#to look at vowel duration in song-level and word-level prominence positions, I filter out only syllables of Q1 and Q2, and only those shapes which surface in both stressed and unstressed positions 
strictus_data <- filter(data_df, data_df$quantity!="3")

#strictus_data <- filter(strictus_data, nchar(strictus_data$segment)==1)
strictus_data


```

```{r}
ggplot(strictus_data,aes(ictus,duration, shape = ictus)) + 
  
  geom_jitter(color = "violet", alpha = 0.5) +
  facet_wrap("song") +
  labs(x = "beat position", y = "mean vowel duration(s)") + 
  theme_minimal()
ggsave("song_icK_dur.png")
strictus_data %>%
  arrange(duration) %>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%  
  ggplot(aes(stressed,duration, shape = stressed)) + 
    geom_jitter(color = "orange", alpha = 0.5) +
    facet_wrap("song") + 
    labs(x = "word stress", y = "within-song mean vowel duration(s)") + 
    theme_minimal()
ggsave("song_str_dur.png")

ggplot(strictus_data,aes(ictus,duration, shape = ictus)) + 
  geom_jitter(color = "violet", alpha = 0.5) +
  facet_wrap("performer") + 
  labs(x = "beat position", y = "mean vowel duration(s)") + 
  theme_minimal()
ggsave("perf_ick_dur.png")
strictus_data %>%
  arrange(duration) %>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%  
  ggplot(aes(stressed,duration, shape = stressed)) + 
    geom_jitter(color = "orange", alpha = 0.5) +
    facet_wrap("performer") + 
    labs(x = "word stress", y = "within-subject mean vowel duration(s)") + 
    theme_minimal()
ggsave("perf_str_dur.png")
```

```{r}
interaction.plot(strictus_data$stressed,strictus_data$ictus,strictus_data$duration,xlab="stressed",ylab="mean vowel duration(ms)",trace.label = "beat")
```

```{r}
strictus_data %>%
  arrange(duration)%>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%
  ggplot(aes(x=stressed ,y=duration,pattern = ictus)) + 

    geom_boxplot_pattern()+ theme_classic() +
    labs( x= "word stress" ,y = "vowel duration (s)", title = "temporal effects of word stress and beat position in syllable nuclei") + 
    facet_wrap("quantity", labeller = label_both) 
    
  
ggsave("dur_density_qfac.png")


```

```{r}


#shape_df <- filter(strictus_data, strictus_data$shape != "VVC" & strictus_data$shape != "VVCC" & strictus_data$shape != "VV" & strictus_data$shape != "V")
```

```{r}

  
  ggplot(shape_df,aes(x=shape,y=duration, pattern = ictus)) +
  geom_boxplot_pattern()  + theme_classic() +

  labs( x = "syllable shape" ,y = "vowel duration(s)", title = "duration of syllable nuclei on and off the beat in three syllable shapes") 

ggsave("dur_shape_ictus.png")
```

```{r}
shape_df %>%
  arrange(duration)%>%
  mutate(stressed = factor(stressed, levels = c("stressed", "unstressed")))%>%
  ggplot(aes(x=shape,y=duration, pattern = stressed)) +
  #geom_violin() + stat_ydensity() + 
  theme_classic() +
  geom_boxplot_pattern()+
  
  labs( x = "syllable shape" ,y = "vowel duration(s)", title = "duration of stressed and unstressed syllable nuclei in three syllable shapes") 

ggsave("dur_shapestress.png")
```

```{r}
lindesignmod <- lmer(duration ~ ictus + stressed + quantity + ictus*stressed + quantity*ictus + (1|song)+ (1|syll) +(1|shape)+ (1|word)+ (1|performer), data = strictus_data, REML = FALSE)
summary(lindesignmod)
```

```{r}
tab_model(lindesignmod, digits.re = 4)


```

```{r}
tab_model(linnullIntmod, digits.re = 4)
```

```{r}
tab_model(lindesignmod,linnullIntmod, digits.re = 4)
```

```{r}
hist(residuals(lindesignmod))
```

```{r}
qqnorm(residuals(lindesignmod))
```

```{r}
plot(lindesignmod)
```

```{r}
linnullIntmod <- lmer(duration ~  (1|song)+ (1|syll) +(1|shape)+ (1|word)+ (1|performer), data = strictus_data, REML = FALSE)
n1 <- summary(linnullIntmod)
print(n1)
```

```{r}
comp2 <- anova(lindesignmod,linnullIntmod)
print(comp2)
```
