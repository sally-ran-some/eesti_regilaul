---
title: "Quantity and Ictus Duration & space"
output: html_notebook
---

```{r}
library("lme4")
library("ggplot2")
library("broom")
library("dplyr")
quant_df <- read.csv("vowel_master.csv", header= TRUE)
quant_df$ictus <- as.factor(quant_df$ictus)
quant_df$stressed <- as.factor(quant_df$stressed)
quant_df$stressed <- recode_factor(quant_df$stressed, "0" = "unstressed","1" = "stressed")
quant_df$quantity <- as.factor(quant_df$quantity)
quant_df$song <- as.factor(quant_df$song)
quant_df$word <- as.factor(quant_df$word)
head(quant_df)
```

```{r}
quant_data <- filter(quant_df, quant_df$stressed == "stressed")
quant_data
```

```{r}
ggplot(quant_data,aes(quantity, duration, color = quantity)) + 
  #geom_violin()+
  geom_boxplot(alpha = 0.3) +
  #geom_jitter(alpha = 0.5) +
  labs(x = "syllable quantity", y = "mean vowel duration (ms)") + 
  facet_wrap("ictus")
  theme_minimal()
ggsave("q_dur.png")


```

```{r}
maxmdl <- lmer(duration ~ quantity + ictus + quantity*ictus + (1|song)+ (1|word) + (1|performer), data = quant_data, REML = FALSE)
summary(maxmdl)
```

```{r}
nullmdl <- lmer(duration ~ (1|song) + (1|word) + (1|performer) , data = quant_data, REML = FALSE)
summary(nullmdl)
```

```{r}
comp_quant <- anova(maxmdl, nullmdl)
print(comp_quant)

```

```{r}
plot(maxmdl)
```
